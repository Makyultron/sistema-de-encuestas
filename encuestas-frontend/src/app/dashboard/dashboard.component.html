<div class="dashboard-container">
  <!-- Welcome Section -->
  <div class="welcome-section" *ngIf="currentUser$ | async as user">
    <h1>¡Bienvenido, {{ user.name }}!</h1>
    <p>Gestiona tus encuestas y visualiza los resultados desde tu panel de control.</p>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <button mat-raised-button color="primary" (click)="createSurvey()" class="action-button">
      <mat-icon>add</mat-icon>
      Crear Nueva Encuesta
    </button>
    <button mat-raised-button color="accent" (click)="viewSurveys()" class="action-button">
      <mat-icon>list</mat-icon>
      Ver Todas las Encuestas
    </button>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid" *ngIf="!isLoading">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon primary">poll</mat-icon>
          <div class="stat-info">
            <h3>{{ stats.totalSurveys }}</h3>
            <p>Total de Encuestas</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon accent">people</mat-icon>
          <div class="stat-info">
            <h3>{{ stats.totalResponses }}</h3>
            <p>Total de Respuestas</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon success">trending_up</mat-icon>
          <div class="stat-info">
            <h3>{{ stats.activeSurveys }}</h3>
            <p>Encuestas Activas</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <mat-spinner></mat-spinner>
    <p>Cargando datos del dashboard...</p>
  </div>

  <!-- Recent Surveys -->
  <div class="recent-surveys" *ngIf="!isLoading">
    <h2>Encuestas Recientes</h2>
    <div class="surveys-grid" *ngIf="recentSurveys$ | async as surveys; else noSurveys">
      <mat-card class="survey-card" *ngFor="let survey of surveys">
        <mat-card-header>
          <mat-card-title>{{ survey.title }}</mat-card-title>
          <mat-card-subtitle>
            <mat-chip [color]="survey.isActive ? 'primary' : 'warn'" selected>
              {{ survey.isActive ? 'Activa' : 'Inactiva' }}
            </mat-chip>
          </mat-card-subtitle>
        </mat-card-header>
        
        <mat-card-content>
          <p>{{ survey.description }}</p>
          <div class="survey-meta">
            <span><mat-icon>question_answer</mat-icon> {{ survey.questions.length }} preguntas</span>
            <span><mat-icon>people</mat-icon> {{ survey.responseCount || 0 }} respuestas</span>
          </div>
        </mat-card-content>
        
        <mat-card-actions>
          <button mat-button (click)="viewSurveyResults(survey.id!)">
            <mat-icon>analytics</mat-icon>
            Ver Resultados
          </button>
          <button mat-button (click)="shareSurvey(survey)" *ngIf="survey.isActive">
            <mat-icon>share</mat-icon>
            Compartir
          </button>
        </mat-card-actions>
      </mat-card>
    </div>

    <ng-template #noSurveys>
      <div class="empty-state">
        <mat-icon class="empty-icon">poll</mat-icon>
        <h3>No tienes encuestas aún</h3>
        <p>Crea tu primera encuesta para comenzar a recopilar respuestas.</p>
        <button mat-raised-button color="primary" (click)="createSurvey()">
          <mat-icon>add</mat-icon>
          Crear Primera Encuesta
        </button>
      </div>
    </ng-template>
  </div>
</div>
